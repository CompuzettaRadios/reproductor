<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mis Albanzas</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            padding: 10px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 20px;
            color: white;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        header h1 {
            font-size: clamp(1.8em, 4vw, 2.5em);
            margin-bottom: 5px;
        }

        header p {
            font-size: clamp(0.9em, 2vw, 1.1em);
            opacity: 0.9;
        }

        .player-card {
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
            padding: 20px;
            margin-bottom: 15px;
        }

        .search-section {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        #searchInput {
            flex: 1;
            min-width: 200px;
            padding: 12px 20px;
            border: 2px solid #e1e5e9;
            border-radius: 25px;
            font-size: 16px;
            outline: none;
            transition: all 0.3s ease;
        }

        #searchInput:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .refresh-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .refresh-btn:hover {
            background: #5a67d8;
            transform: translateY(-2px);
        }

        .player-section {
            display: grid;
            grid-template-columns: auto 1fr auto;
            gap: 20px;
            align-items: center;
            margin-bottom: 20px;
        }

        .album-art img {
            width: 80px;
            height: 80px;
            border-radius: 12px;
            object-fit: cover;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .song-info h3 {
            font-size: 1.2em;
            margin-bottom: 5px;
            color: #333;
        }

        .song-info p {
            color: #666;
            font-size: 0.9em;
        }

        .controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .controls button {
            width: 45px;
            height: 45px;
            border: none;
            border-radius: 50%;
            background: #667eea;
            color: white;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .controls button:hover {
            background: #5a67d8;
            transform: scale(1.05);
        }

        #playBtn {
            width: 50px;
            height: 50px;
            font-size: 18px;
        }

        .progress-section {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.85em;
            color: #666;
        }

        .progress-bar {
            flex: 1;
            height: 6px;
            background: #e1e5e9;
            border-radius: 3px;
            cursor: pointer;
            overflow: hidden;
        }

        .progress {
            height: 100%;
            background: #667eea;
            border-radius: 3px;
            transition: width 0.1s ease;
        }

        .playlist-section h2 {
            margin-bottom: 15px;
            color: #333;
            font-size: 1.3em;
        }

        .stats {
            text-align: center;
            margin-bottom: 15px;
            font-size: 0.9em;
            color: #666;
        }

        .playlist {
            max-height: 400px;
            overflow-y: auto;
            border-radius: 10px;
        }

        .playlist::-webkit-scrollbar {
            width: 6px;
        }

        .playlist::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }

        .playlist::-webkit-scrollbar-thumb {
            background: #667eea;
            border-radius: 3px;
        }

        .song-item {
            display: flex;
            align-items: center;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 5px;
        }

        .song-item:hover {
            background: #f8f9fa;
            transform: translateX(3px);
        }

        .song-item.active {
            background: #667eea;
            color: white;
        }

        .song-cover {
            width: 40px;
            height: 40px;
            border-radius: 6px;
            object-fit: cover;
            margin-right: 12px;
        }

        .song-details {
            flex: 1;
            min-width: 0;
        }

        .song-title {
            font-weight: 600;
            font-size: 0.95em;
            margin-bottom: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .song-artist {
            font-size: 0.8em;
            opacity: 0.7;
        }

        .song-duration {
            font-size: 0.85em;
            color: #999;
        }

        .song-item.active .song-duration,
        .song-item.active .song-artist {
            color: rgba(255,255,255,0.8);
        }

        .message {
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            text-align: center;
            font-size: 0.9em;
        }

        .error-message {
            background: #fee;
            color: #c33;
        }

        .success-message {
            background: #efe;
            color: #090;
        }

        .info-message {
            background: #e3f2fd;
            color: #1976d2;
        }

        .loading {
            text-align: center;
            color: white;
            padding: 20px;
            font-size: 1.1em;
        }

        .no-songs {
            text-align: center;
            color: #666;
            padding: 30px;
            font-style: italic;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            body {
                padding: 5px;
            }

            .player-section {
                grid-template-columns: 1fr;
                gap: 15px;
                text-align: center;
            }

            .song-info h3 {
                font-size: 1.1em;
            }

            .search-section {
                flex-direction: column;
            }

            #searchInput {
                min-width: 100%;
            }

            .playlist {
                max-height: 300px;
            }

            .controls button {
                width: 40px;
                height: 40px;
                font-size: 14px;
            }

            #playBtn {
                width: 45px;
                height: 45px;
                font-size: 16px;
            }
        }

        @media (max-width: 480px) {
            .player-card {
                padding: 15px;
            }

            .song-item {
                padding: 10px;
            }

            .song-cover {
                width: 35px;
                height: 35px;
            }

            .album-art img {
                width: 60px;
                height: 60px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìñ Himnario Digital</h1>
            <p>Colecci√≥n de alabanzas variadas</p>
        </header>

        <div id="loading" class="loading">
            Cargando himnos...
        </div>

        <div id="mainContent" style="display: none;">
            <div class="player-card">
                <div class="search-section">
                    <input type="text" id="searchInput" placeholder="Buscar himno...">
                    <button class="refresh-btn" id="refreshBtn">üîÑ Actualizar</button>
                </div>

                <div class="player-section">
                    <div class="album-art">
                        <img id="albumCover" src="" alt="Car√°tula">
                    </div>
                    <div class="song-info">
                        <h3 id="songTitle">Selecciona un himno</h3>
                        <p id="songArtist">-</p>
                    </div>
                    <div class="controls">
                        <button id="prevBtn">‚èÆ</button>
                        <button id="playBtn">‚ñ∂</button>
                        <button id="nextBtn">‚è≠</button>
                    </div>
                </div>

                <div class="progress-section">
                    <span id="currentTime">0:00</span>
                    <div class="progress-bar">
                        <div class="progress" id="progress"></div>
                    </div>
                    <span id="duration">0:00</span>
                </div>

                <audio id="audioPlayer"></audio>
            </div>

            <div class="player-card playlist-section">
                <h2>Lista de Himnos</h2>
                <div id="stats" class="stats"></div>
                <div id="messages"></div>
                <div id="playlist" class="playlist"></div>
            </div>
        </div>
    </div>

    <script>
        class HymnPlayer {
            constructor() {
                this.songs = [];
                this.filteredSongs = [];
                this.currentIndex = 0;
                this.isPlaying = false;
                this.audio = document.getElementById('audioPlayer');
                
                this.initializeElements();
                this.loadSongs();
                this.setupEventListeners();
            }

            initializeElements() {
                this.playBtn = document.getElementById('playBtn');
                this.prevBtn = document.getElementById('prevBtn');
                this.nextBtn = document.getElementById('nextBtn');
                this.progress = document.getElementById('progress');
                this.progressBar = document.querySelector('.progress-bar');
                this.currentTime = document.getElementById('currentTime');
                this.duration = document.getElementById('duration');
                this.songTitle = document.getElementById('songTitle');
                this.songArtist = document.getElementById('songArtist');
                this.albumCover = document.getElementById('albumCover');
                this.playlist = document.getElementById('playlist');
                this.searchInput = document.getElementById('searchInput');
                this.refreshBtn = document.getElementById('refreshBtn');
                this.loading = document.getElementById('loading');
                this.mainContent = document.getElementById('mainContent');
                this.stats = document.getElementById('stats');
                this.messages = document.getElementById('messages');
            }

            // ======================== INICIO SECCI√ìN A REEMPLAZAR ========================
            async loadSongs() {
    console.log('üéµ Cargando lista de canciones generada autom√°ticamente...');
    this.showMessage('Cargando canciones...', 'info');
    
    // Lista generada autom√°ticamente por el Administrador de M√∫sica
    // √öltima actualizaci√≥n: 5/8/2025, 21:29:07
    // Total de archivos: 11
    this.songs = [
        {
                "title": "1.  Adoradle",
                "artist": "Himno Tradicional",
                "file": "mp3/himnos/1.- Adoradle.mp3",
                "genre": "himnos",
                "cover": "mp3/himnos/cover.jpg",
                "duration": "0:00",
                "filename": "1.- Adoradle.mp3"
        },
        {
                "title": "2.  Dulce Comuni√≥N",
                "artist": "Himno Tradicional",
                "file": "mp3/himnos/2.- Dulce Comuni√≥n.mp3",
                "genre": "himnos",
                "cover": "mp3/himnos/cover.jpg",
                "duration": "0:00",
                "filename": "2.- Dulce Comuni√≥n.mp3"
        },
        {
                "title": "3.  Cerca De Ti Se√±Or",
                "artist": "Himno Tradicional",
                "file": "mp3/himnos/3.- Cerca de ti Se√±or.mp3",
                "genre": "himnos",
                "cover": "mp3/himnos/cover.jpg",
                "duration": "0:00",
                "filename": "3.- Cerca de ti Se√±or.mp3"
        },
        {
                "title": "4.  El Gran M√©Dico",
                "artist": "Himno Tradicional",
                "file": "mp3/himnos/4.- El gran m√©dico.mp3",
                "genre": "himnos",
                "cover": "mp3/himnos/cover.jpg",
                "duration": "0:00",
                "filename": "4.- El gran m√©dico.mp3"
        },
        {
                "title": "7.  Todo A Cristo Yo Me Rindo",
                "artist": "Himno Tradicional",
                "file": "mp3/himnos/7.- Todo a Cristo yo me rindo.mp3",
                "genre": "himnos",
                "cover": "mp3/himnos/cover.jpg",
                "duration": "0:00",
                "filename": "7.- Todo a Cristo yo me rindo.mp3"
        },
        {
                "title": "10.  Melod√≠As Celestiales",
                "artist": "Himno Tradicional",
                "file": "mp3/himnos/10.- Melod√≠as Celestiales.mp3",
                "genre": "himnos",
                "cover": "mp3/himnos/cover.jpg",
                "duration": "0:00",
                "filename": "10.- Melod√≠as Celestiales.mp3"
        },
        {
                "title": "13.  Dulce Oraci√≥N",
                "artist": "Himno Tradicional",
                "file": "mp3/himnos/13.- Dulce Oraci√≥n.mp3",
                "genre": "himnos",
                "cover": "mp3/himnos/cover.jpg",
                "duration": "0:00",
                "filename": "13.- Dulce Oraci√≥n.mp3"
        },
        {
                "title": "14.  Oh Que Amigo",
                "artist": "Himno Tradicional",
                "file": "mp3/himnos/14.- Oh que amigo.mp3",
                "genre": "himnos",
                "cover": "mp3/himnos/cover.jpg",
                "duration": "0:00",
                "filename": "14.- Oh que amigo.mp3"
        },
        {
                "title": "22.  Oh Yo Quiero Andar Con Cristo",
                "artist": "Himno Tradicional",
                "file": "mp3/himnos/22.- Oh yo quiero andar con Cristo.mp3",
                "genre": "himnos",
                "cover": "mp3/himnos/cover.jpg",
                "duration": "0:00",
                "filename": "22.- Oh yo quiero andar con Cristo.mp3"
        },
        {
                "title": "29.  Digno Es El Cordero",
                "artist": "Himno Tradicional",
                "file": "mp3/himnos/29.- Digno es el cordero.mp3",
                "genre": "himnos",
                "cover": "mp3/himnos/cover.jpg",
                "duration": "0:00",
                "filename": "29.- Digno es el cordero.mp3"
        },
        {
                "title": "69.  Precioso Es Jes√∫S",
                "artist": "Himno Tradicional",
                "file": "mp3/himnos/69.- Precioso es Jes√∫s.mp3",
                "genre": "himnos",
                "cover": "mp3/himnos/cover.jpg",
                "duration": "0:00",
                "filename": "69.- Precioso es Jes√∫s.mp3"
        }
];
    
    // Calcular estad√≠sticas
    const stats = { 
        total: this.songs.length,
        coros: this.songs.filter(s => s.genre === 'coros').length,
        himnos: this.songs.filter(s => s.genre === 'himnos').length,
        testimoniales: this.songs.filter(s => s.genre === 'testimoniales').length,
        especiales: this.songs.filter(s => s.genre === 'especiales').length
    };
    
    this.showStats(stats);
    
    if (this.songs.length > 0) {
        this.showMessage(`‚úÖ ${this.songs.length} canciones cargadas exitosamente`, 'success');
        console.log('üìö Canciones cargadas:', this.songs);
    } else {
        this.showMessage('‚ö†Ô∏è No se encontraron archivos MP3.', 'error');
    }
    
    this.filteredSongs = [...this.songs];
    this.renderPlaylist();
    
    if (this.songs.length > 0) {
        this.loadSong(0);
    }
    
    // Ocultar loading y mostrar contenido
    setTimeout(() => {
        this.loading.style.display = 'none';
        this.mainContent.style.display = 'block';
    }, 1000);
}
            // ======================== FIN SECCI√ìN A REEMPLAZAR ========================

            showStats(stats) {
                this.stats.innerHTML = `Total de himnos: ${stats.total}`;
            }

            showMessage(text, type = 'info') {
                const messageClass = type === 'error' ? 'error-message' : 
                                   type === 'success' ? 'success-message' : 
                                   'info-message';
                
                this.messages.innerHTML = `<div class="message ${messageClass}">${text}</div>`;
                
                if (type !== 'error') {
                    setTimeout(() => {
                        this.messages.innerHTML = '';
                    }, 3000);
                }
            }

            setupEventListeners() {
                this.playBtn.addEventListener('click', () => this.togglePlay());
                this.prevBtn.addEventListener('click', () => this.previousSong());
                this.nextBtn.addEventListener('click', () => this.nextSong());
                this.refreshBtn.addEventListener('click', () => this.refreshSongs());
                this.progressBar.addEventListener('click', (e) => this.setProgress(e));
                this.audio.addEventListener('timeupdate', () => this.updateProgress());
                this.audio.addEventListener('ended', () => this.nextSong());
                this.audio.addEventListener('loadedmetadata', () => this.updateDuration());
                this.audio.addEventListener('error', (e) => this.handleAudioError(e));
                this.searchInput.addEventListener('input', (e) => this.filterSongs(e.target.value));

                // Atajos de teclado
                document.addEventListener('keydown', (e) => {
                    if (e.target === this.searchInput) return;
                    
                    switch(e.code) {
                        case 'Space':
                            e.preventDefault();
                            this.togglePlay();
                            break;
                        case 'ArrowLeft':
                            e.preventDefault();
                            this.previousSong();
                            break;
                        case 'ArrowRight':
                            e.preventDefault();
                            this.nextSong();
                            break;
                    }
                });
            }

            async refreshSongs() {
                this.showMessage('Actualizando lista...', 'info');
                this.refreshBtn.disabled = true;
                this.refreshBtn.textContent = 'üîÑ Actualizando...';
                
                await this.loadSongs();
                
                this.refreshBtn.disabled = false;
                this.refreshBtn.textContent = 'üîÑ Actualizar';
            }

            handleAudioError(e) {
                console.error('Error al cargar audio:', e);
                this.showMessage(`Error al cargar: ${this.filteredSongs[this.currentIndex]?.title || 'archivo'}`, 'error');
            }

            loadSong(index) {
                if (index < 0 || index >= this.filteredSongs.length) return;
                
                this.currentIndex = index;
                const song = this.filteredSongs[index];
                
                this.audio.src = song.file;
                this.songTitle.textContent = song.title;
                this.songArtist.textContent = song.artist || 'Himno Tradicional';
                
                this.loadAlbumCover(song.cover);
                this.updateActiveItem();
            }

            loadAlbumCover(coverPath) {
                const img = new Image();
                img.onload = () => {
                    this.albumCover.src = coverPath;
                };
                img.onerror = () => {
                    this.albumCover.src = this.createDefaultCover();
                };
                img.src = coverPath;
            }

            createDefaultCover() {
                return `data:image/svg+xml,${encodeURIComponent(`
                    <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 80 80">
                        <defs>
                            <linearGradient id="grad" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#764ba2;stop-opacity:1" />
                            </linearGradient>
                        </defs>
                        <rect width="80" height="80" fill="url(#grad)"/>
                        <text x="40" y="35" text-anchor="middle" font-family="Arial" font-size="16" fill="white">üìñ</text>
                        <text x="40" y="50" text-anchor="middle" font-family="Arial" font-size="8" fill="white">Himno</text>
                    </svg>
                `)}`;
            }

            togglePlay() {
                if (this.filteredSongs.length === 0) return;
                
                if (this.isPlaying) {
                    this.audio.pause();
                    this.playBtn.textContent = '‚ñ∂';
                    this.isPlaying = false;
                } else {
                    const playPromise = this.audio.play();
                    if (playPromise !== undefined) {
                        playPromise.then(() => {
                            this.playBtn.textContent = '‚è∏';
                            this.isPlaying = true;
                        }).catch(error => {
                            console.error('Error al reproducir:', error);
                            this.handleAudioError(error);
                        });
                    }
                }
            }

            previousSong() {
                if (this.filteredSongs.length === 0) return;
                const newIndex = this.currentIndex > 0 ? this.currentIndex - 1 : this.filteredSongs.length - 1;
                this.loadSong(newIndex);
                if (this.isPlaying) {
                    this.audio.play();
                }
            }

            nextSong() {
                if (this.filteredSongs.length === 0) return;
                const newIndex = this.currentIndex < this.filteredSongs.length - 1 ? this.currentIndex + 1 : 0;
                this.loadSong(newIndex);
                if (this.isPlaying) {
                    this.audio.play();
                }
            }

            updateProgress() {
                const { currentTime, duration } = this.audio;
                if (duration) {
                    const progressPercent = (currentTime / duration) * 100;
                    this.progress.style.width = `${progressPercent}%`;
                }
                
                this.currentTime.textContent = this.formatTime(currentTime);
            }

            updateDuration() {
                this.duration.textContent = this.formatTime(this.audio.duration);
            }

            setProgress(e) {
                const clickX = e.offsetX;
                const width = this.progressBar.offsetWidth;
                const duration = this.audio.duration;
                
                if (duration) {
                    this.audio.currentTime = (clickX / width) * duration;
                }
            }

            formatTime(seconds) {
                if (isNaN(seconds)) return '0:00';
                
                const mins = Math.floor(seconds / 60);
                const secs = Math.floor(seconds % 60);
                
                return `${mins}:${secs.toString().padStart(2, '0')}`;
            }

            renderPlaylist() {
                this.playlist.innerHTML = '';
                
                if (this.filteredSongs.length === 0) {
                    this.playlist.innerHTML = '<div class="no-songs">No se encontraron himnos.</div>';
                    return;
                }
                
                this.filteredSongs.forEach((song, index) => {
                    const songItem = document.createElement('div');
                    songItem.className = 'song-item';
                    
                    songItem.innerHTML = `
                        <img src="${song.cover}" alt="${song.title}" class="song-cover" 
                             onerror="this.src='${this.createDefaultCover()}'">
                        <div class="song-details">
                            <div class="song-title">${song.title}</div>
                            <div class="song-artist">${song.artist}</div>
                        </div>
                        <div class="song-duration">${song.duration}</div>
                    `;
                    
                    songItem.addEventListener('click', () => {
                        this.loadSong(index);
                        if (!this.isPlaying) {
                            this.togglePlay();
                        }
                    });
                    
                    this.playlist.appendChild(songItem);
                });

                this.updateActiveItem();
            }

            updateActiveItem() {
                const items = this.playlist.querySelectorAll('.song-item');
                items.forEach((item, index) => {
                    item.classList.toggle('active', index === this.currentIndex);
                });
            }

            filterSongs(searchTerm) {
                const filtered = this.songs.filter(song => 
                    song.title.toLowerCase().includes(searchTerm.toLowerCase()) ||
                    (song.artist && song.artist.toLowerCase().includes(searchTerm.toLowerCase()))
                );
                
                this.filteredSongs = filtered;
                this.currentIndex = 0;
                this.renderPlaylist();
                
                if (this.filteredSongs.length > 0) {
                    this.loadSong(0);
                }
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            const player = new HymnPlayer();
        });
    </script>
</body>
</html>
